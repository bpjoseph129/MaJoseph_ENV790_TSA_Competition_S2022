---
title: "ForecastCompetition"
author: "Ben and Yiyan"
date: "4/3/2022"
output: pdf_document
---

Questions for Luana:
- How to select all weather stations when mutating from hrly to daily
- How to deal with the large txt file issue

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(lubridate)
library(ggplot2)
library(forecast)  
library(Kendall)
library(tseries)
library(outliers)
library(tidyverse)
library(smooth)
library(zoo)
library(kableExtra)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r read_ata}
library(readxl)
load <- read_excel("Data/load.xlsx")
humidity <- read_excel("Data/relative_humidity.xlsx")
temp <- read_excel("Data/temperature.xlsx")

summarize(humidity)

#Fixing date columns and selecting active power only column
humidity_2 <- humidity %>% 
  #mutate( rh_ws1 = as.numeric(rh_ws1)) %>%  
  mutate( Date = ymd(date)) %>% 
  #mutate( hr = hms(Time)) %>% 
  mutate( Year = year(date), 
          Month = month(date), 
          Day = day(date)) %>% 
          #Hour = hour(Time), 
          #Min = minute(Time)) %>% 
  select( Date, Year, Month, Day, rh_ws1)

temp_2 <- temp %>% 
  #mutate( rh_ws1 = as.numeric(rh_ws1)) %>%  
  mutate( Date = ymd(date)) %>% 
  #mutate( hr = hms(Time)) %>% 
  mutate( Year = year(date), 
          Month = month(date), 
          Day = day(date)) %>% 
          #Hour = hour(Time), 
          #Min = minute(Time)) %>% 
  select( Date, Year, Month, Day, t_ws1)


#Creating a data frame with daily observations
humidity_daily <- humidity_2 %>% 
  filter( !is.na(rh_ws1)) %>% 
  group_by(Date,Year,Month,Day) %>% # here we left column with hour out to calculate daily mean
  summarise( daily_humidity_ws1 = mean(rh_ws1)) 

#Creating a data frame with daily observations
temp_daily <- temp_2 %>% 
  filter( !is.na(t_ws1)) %>% 
  group_by(Date,Year,Month,Day) %>% # here we left column with hour out to calculate daily mean
  summarise( daily_temp_ws1 = mean(t_ws1)) 

empty_col <- ("Daily Average")
load[,empty_col] <- NA
load$`Daily Average` <- rowMeans(load[,(3:26)])

load <- load[-c(1,3:26)]

```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}

#make load a ts object

ts_load <- msts(load$`Daily Average`, 
                           seasonal.periods =c(7,365.25),
                           start=c(2005,1,1))

ts_load_09 <- msts(load$`Daily Average`, 
                           seasonal.periods =c(7,365.25),
                           start=c(2005,1,1),end=c(2009,12,31))
plot(ts_load_09)
head(ts_load,15)

##decompose
#ts_load_09 %>% mstl() %>%
#  autoplot()

decompose_load_09<-mstl(ts_load_09)
deseasonal_load_09 <- seasadj(decompose_load_09) 

plot(deseasonal_load_09)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
```{r}
#Model 1: Arithmetic mean on original data
MEAN_seas <- meanf(y = ts_load_09, h = 31)
plot(MEAN_seas)

#Model 2: Arithmetic mean on deseas data
MEAN_deseas <- meanf(deseasonal_load_09, h=31)
plot(MEAN_deseas)

#Model 3: Seasonal naive on original data
SNAIVE_seas <- snaive(ts_load_09, h=31)
plot(SNAIVE_seas)

#Model 4: Naive on deseas data
NAIVE_deseas <- naive(deseasonal_load_09, h=31)
plot(NAIVE_deseas)
```

